<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta
  name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
/>
<title>For You ğŸ’–</title>

<style>
html, body {
  width: 100%;
  height: 100%;
  margin: 0;
  overflow: hidden;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: "Comic Sans MS", cursive;
  background: radial-gradient(circle, #ffb6c1, #ff69b4);
  text-align: center;
  touch-action: manipulation;
}

/* ğŸ”Š Sound hint */
#soundHint {
  position: fixed;
  bottom: 15px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6);
  color: white;
  padding: 10px 18px;
  border-radius: 20px;
  font-size: 16px;
  z-index: 3000;
  animation: pulse 1.5s infinite;
}
@keyframes pulse {
  0% { opacity: .5; }
  50% { opacity: 1; }
  100% { opacity: .5; }
}

/* Instruction */
#instruction {
  position: fixed;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255,255,255,.95);
  color: #ff1493;
  padding: 22px 30px;
  font-size: 26px;
  border-radius: 18px;
  animation: fadeOut 4s forwards;
  z-index: 1200;
}
@keyframes fadeOut {
  0%,70% { opacity: 1; }
  100% { opacity: 0; pointer-events: none; }
}

/* HUD */
#hud {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  color: white;
  font-size: 20px;
  z-index: 1100;
}
#bar {
  width: 320px;
  height: 18px;
  background: rgba(255,255,255,.4);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 8px;
}
#fill {
  width: 0%;
  height: 100%;
  background: red;
  transition: width .3s;
}

/* Hearts */
.heart {
  position: absolute;
  font-size: 32px;
  cursor: pointer;
  animation: float 6s linear infinite;
  z-index: 800;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
}
@media (max-width: 768px) {
  .heart { font-size: 42px; }
}
@keyframes float {
  from { transform: translateY(110vh); }
  to { transform: translateY(-120px); }
}

/* Final Screen */
#final {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.75);
  color: white;
  z-index: 2000;
}
#finalContent {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 15px;
}
.message {
  font-size: 22px;
  max-width: 600px;
  opacity: 0;
  transition: opacity 1s;
}
.buttons {
  display: flex;
  gap: 20px;
}
button {
  padding: 15px 35px;
  font-size: 22px;
  border: none;
  border-radius: 14px;
  cursor: pointer;
}
#yesBtn { background: hotpink; }
#noBtn {
  background: #555;
  color: white;
  position: relative;
}

/* Fireworks */
#fireworks {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 500;
}
</style>
</head>

<body>

<audio id="bgMusic" src="music.mp3" preload="auto" loop></audio>
<div id="soundHint">ğŸ”Š Tap anywhere to play sound</div>

<canvas id="fireworks"></canvas>

<div id="instruction">
  ğŸ’• Catch the hearts to fill up the meter ğŸ’•
</div>

<div id="hud">
  Love Meter ğŸ’–
  <div id="bar"><div id="fill"></div></div>
</div>

<div id="final">
  <div id="finalContent">
    <h1>ğŸ’– Waleh, be my Valentine ğŸ’–</h1>
    <div class="buttons">
      <button id="yesBtn" onclick="handleYes()">YES ğŸ’</button>
      <button id="noBtn">NO ğŸ˜ˆ</button>
    </div>
    <div class="message" id="loveMessage">
      Your existence in my life is a blessing from God ğŸ’–
    </div>
  </div>
</div>

<script>
/* ğŸ”Š MUSIC */
const music = document.getElementById("bgMusic");
function enableSound() {
  music.volume = 0.6;
  music.play().catch(()=>{});
  document.getElementById("soundHint").remove();
  document.removeEventListener("click", enableSound);
}
document.addEventListener("click", enableSound);

/* ğŸš« Prevent scroll on iOS */
document.addEventListener("touchmove", e => e.preventDefault(), { passive:false });

/* â¤ï¸ GAME */
let love = 0;

function spawnHeart() {
  const h = document.createElement("div");
  h.className = "heart";
  h.textContent = "â¤ï¸";
  h.style.left = Math.random() * (innerWidth - 40) + "px";
  h.style.animationDuration = (4 + Math.random()*4) + "s";

  const collect = e => {
    e.preventDefault();
    if (navigator.vibrate) navigator.vibrate(20);
    love += 10;
    if (love > 100) love = 100;
    document.getElementById("fill").style.width = love + "%";
    h.remove();
    if (love === 100) document.getElementById("final").style.display = "block";
  };

  h.addEventListener("click", collect);
  h.addEventListener("touchstart", collect, { passive:false });

  document.body.appendChild(h);
  setTimeout(()=>h.remove(),9000);
}

setTimeout(()=>setInterval(spawnHeart,700),2000);
setTimeout(()=>document.getElementById("instruction").remove(),4500);

/* ğŸ˜ˆ RUNAWAY NO */
const noBtn = document.getElementById("noBtn");
function moveNo(){
  noBtn.style.transform =
    `translate(${Math.random()*300-150}px,${Math.random()*200-100}px)`;
}
noBtn.addEventListener("mouseenter", moveNo);
noBtn.addEventListener("touchstart", moveNo);

/* ğŸ“± WHATSAPP (iOS SAFE) */
function sendWhatsAppResponse() {
  const number = "97472149940";
  const message =
    "I said YES ğŸ’–\nMy existence in your life is a blessing from God âœ¨";
  const encoded = encodeURIComponent(message);

  // App deep link
  window.location.href = `whatsapp://send?phone=${number}&text=${encoded}`;

  // Fallback (desktop / no app)
  setTimeout(() => {
    window.location.href = `https://wa.me/${number}?text=${encoded}`;
  }, 800);
}

/* ğŸ’ YES */
function handleYes() {
  document.getElementById("loveMessage").style.opacity = 1;
  if (navigator.vibrate) navigator.vibrate(40);
  startFireworks();

  // Must be immediate for iOS
  sendWhatsAppResponse();
}

/* ğŸ† FIREWORKS */
const canvas = document.getElementById("fireworks");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let particles = [], active = false;

function startFireworks(){ active = true; launch(); }

function launch(){
  if(!active) return;
  const x=Math.random()*canvas.width, y=Math.random()*canvas.height*.5;
  for(let i=0;i<100;i++){
    const a=Math.random()*Math.PI*2, s=Math.random()*6+2;
    particles.push({x,y,dx:Math.cos(a)*s,dy:Math.sin(a)*s,life:80,
      color:`hsl(${Math.random()*360},100%,60%)`});
  }
  setTimeout(launch,450);
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>{
    p.x+=p.dx; p.y+=p.dy; p.dy+=.05; p.life--;
    ctx.beginPath();
    ctx.arc(p.x,p.y,2.5,0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.fill();
  });
  particles=particles.filter(p=>p.life>0);
  requestAnimationFrame(animate);
}
animate();

onresize=()=>{canvas.width=innerWidth;canvas.height=innerHeight};
</script>

</body>
</html>
